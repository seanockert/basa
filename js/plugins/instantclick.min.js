/*
* InstantClick 3.1.0
* Preloads content behind a hyperlink before clicking it to serve it up ultrafast
* (c) 2014 Alexandre Dieulot
* https://github.com/dieulot/instantclick
*/

var instantClick,InstantClick=instantClick=function(a,b,c){function v(a){var b=a.indexOf("#");return 0>b?a:a.substr(0,b)}function w(a){for(;a&&"A"!=a.nodeName;)a=a.parentNode;return a}function x(a){do{if(!a.hasAttribute)break;if(a.hasAttribute("data-instant"))return!1;if(a.hasAttribute("data-no-instant"))return!0}while(a=a.parentNode);return!1}function y(a){var c=b.protocol+"//"+b.host;return a.target||a.hasAttribute("download")||0!=a.href.indexOf(c+"/")||a.href.indexOf("#")>-1&&v(a.href)==e||x(a)?!1:!0}function z(a,b,c,d){for(var e=!1,f=0;f<u[a].length;f++)if("receive"==a){var g=u[a][f](b,c,d);g&&("body"in g&&(c=g.body),"title"in g&&(d=g.title),e=g)}else u[a][f](b,c,d);return e}function A(b,c,f,g,h){if(a.documentElement.replaceChild(c,a.body),f){history.pushState(null,null,f);var i=f.indexOf("#"),j=i>-1&&a.getElementById(f.substr(i+1)),k=0;if(j)for(;j.offsetParent;)k+=j.offsetTop,j=j.offsetParent;scrollTo(0,k),e=v(f)}else scrollTo(0,g);d&&a.title==b?a.title=b+String.fromCharCode(160):a.title=b,K(),h?z("restore"):z("change",!1)}function B(){p=!1,q=!1}function C(a){return a.replace(/<noscript[\s\S]+?<\/noscript>/gi,"")}function D(a){if(!(h>+new Date-500)){var b=w(a.target);b&&y(b)&&L(b.href)}}function E(a){if(!(h>+new Date-500)){var b=w(a.target);b&&y(b)&&(b.addEventListener("mouseout",H),t?(f=b.href,g=setTimeout(L,t)):L(b.href))}}function F(a){h=+new Date;var b=w(a.target);b&&y(b)&&(s?b.removeEventListener("mousedown",D):b.removeEventListener("mouseover",E),L(b.href))}function G(a){var b=w(a.target);b&&y(b)&&(a.which>1||a.metaKey||a.ctrlKey||(a.preventDefault(),M(b.href)))}function H(){return g?(clearTimeout(g),void(g=!1)):void(p&&!q&&(j.abort(),B()))}function I(){if(!(j.readyState<4)&&0!=j.status){if(o.ready=+new Date-o.start,j.getResponseHeader("Content-Type").match(/\/(x|ht|xht)ml/)){var b=a.implementation.createHTMLDocument("");b.documentElement.innerHTML=C(j.responseText),l=b.title,n=b.body;var c=z("receive",k,n,l);c&&("body"in c&&(n=c.body),"title"in c&&(l=c.title));var d=v(k);i[d]={body:n,title:l,scrollY:d in i?i[d].scrollY:0};for(var g,h,e=b.head.children,f=0,p=0;p<e.length;p++)if(g=e[p],g.hasAttribute("data-instant-track")){h=g.getAttribute("href")||g.getAttribute("src")||g.innerHTML;for(var s=0;s<r.length;s++)r[s]==h&&f++}f!=r.length&&(m=!0)}else m=!0;q&&(q=!1,M(k))}}function J(){var a=v(b.href);if(a!=e){if(!(a in i))return void(b.href=b.href);i[e].scrollY=pageYOffset,e=a,A(i[a].title,i[a].body,!1,i[a].scrollY,!0)}}function K(b){if(a.body.addEventListener("touchstart",F,!0),s?a.body.addEventListener("mousedown",D,!0):a.body.addEventListener("mouseover",E,!0),a.body.addEventListener("click",G,!0),!b)for(var d,e,f,g,c=a.body.getElementsByTagName("script"),h=0,i=c.length;i>h;h++)d=c[h],d.hasAttribute("data-no-instant")||(e=a.createElement("script"),d.src&&(e.src=d.src),d.innerHTML&&(e.innerHTML=d.innerHTML),f=d.parentNode,g=d.nextSibling,f.removeChild(d),f.insertBefore(e,g))}function L(a){!s&&"display"in o&&+new Date-(o.start+o.display)<100||(g&&(clearTimeout(g),g=!1),a||(a=f),(!p||a!=k&&!q)&&(p=!0,q=!1,k=a,n=!1,m=!1,o={start:+new Date},z("fetch"),j.open("GET",a),j.send()))}function M(a){return"display"in o||(o.display=+new Date-o.start),g||!p?g&&k&&k!=a?void(b.href=a):(L(a),z("wait"),void(q=!0)):q?void(b.href=a):m?void(b.href=k):n?(i[e].scrollY=pageYOffset,B(),void A(l,n,k)):(z("wait"),void(q=!0))}function O(c){if(!e){if(!N)return void z("change",!0);"mousedown"==c?s=!0:"number"==typeof c&&(t=c),e=v(b.href),i[e]={body:a.body,title:a.title,scrollY:pageYOffset};for(var f,g,d=a.head.children,h=0;h<d.length;h++)f=d[h],f.hasAttribute("data-instant-track")&&(g=f.getAttribute("href")||f.getAttribute("src")||f.innerHTML,r.push(g));j=new XMLHttpRequest,j.addEventListener("readystatechange",I),K(!0),z("change",!0),addEventListener("popstate",J)}}function P(a,b){u[a].push(b)}var e,f,g,h,j,s,t,d=c.indexOf(" CriOS/")>-1,i={},k=!1,l=!1,m=!1,n=!1,o={},p=!1,q=!1,r=[],u={fetch:[],receive:[],wait:[],change:[],restore:[]},N="pushState"in history&&(!c.match("Android")||c.match("Chrome/"))&&"file:"!=b.protocol;return{supported:N,init:O,on:P}}(document,location,navigator.userAgent);