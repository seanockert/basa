/*
* Type.js 1.0
* (c) 2015 Nathan Ford
* http://typejs.org/
* Features: kerning pairs, rag adjust, min/max font size, widow tamer
*/

var stylefill={options:{externalCSS:!1},properties:new Object,allRules:new Object,sheets:new Array,sheetTexts:new Object,arraySliceShim:function(){"use strict";var a=Array.prototype.slice;try{a.call(document.documentElement)}catch(b){Array.prototype.slice=function(b,c){var d,e=this.length,f=[];if(this.charAt)for(d=0;e>d;d++)f.push(this.charAt(d));else for(d=0;d<this.length;d++)f.push(this[d]);return a.call(f,b,c||f.length)}}},options:function(a){this.options=a},init:function(a){this.properties=a,this.arraySliceShim(),this.getStyleSheets()},loadStyles:function(a){var b=this.sheets[a];b?b.innerHTML?this.loadCSSinner(b,a):!stylefill.sheets[b.href]&&stylefill.options.externalCSS?stylefill.loadFile(b.href,a):stylefill.loadStyles(a+1):stylefill.runSheets()},loadCSSinner:function(a,b){this.sheetTexts["onpage"+b]=a.innerHTML,this.loadStyles(b+1)},loadFile:function(a,b){var c;c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),c.open("GET",a,!0),c.onreadystatechange=function(){4==this.readyState&&200==this.status?(stylefill.sheetTexts[a]=this.responseText,stylefill.loadStyles(b+1)):4==this.readyState&&0==this.status&&stylefill.loadStyles(b+1)},c.send(null)},getStyleSheets:function(){var d=(new Array,Array.prototype.slice.call(document.querySelectorAll('link[href*=".css"]'))),e=document.getElementsByTagName("style");if(e.length>0)for(i in e)e[i].innerHTML&&d.push(Array.prototype.slice.call(e)[i]);this.sheets=d,this.loadStyles(0)},runSheets:function(){for(sheet in this.sheetTexts)for(property in this.properties){var a=this.sheetTexts[sheet],b=this.properties[property];this.findRules(property,a,b)}},checkRule:function(a){var b=a.replace(/(^|-)([a-z])/g,function(a,b,c){return c.toUpperCase()});return"Webkit"+b in document.body.style||"Moz"+b in document.body.style||"O"+b in document.body.style||a in document.body.style?!0:void 0},findRules:function(a,b,c){var d={support:!1};if(b){if(this.checkRule(a))d.support=!0;else for(var f,e=new RegExp("([^}{]+){([^}]+)?"+a.replace("-","\\-")+"[\\s\\t]*:[\\s\\t]*([^;]+)","gi"),g=0;f=e.exec(b);){var h=f[1].replace(/^([\s\n\r\t]+|\/\*.*?\*\/)+/,"").replace(/[\s\n\r\t]+$/,""),i=f[3];d["rule"+g]={selector:h,property:a,value:i},stylefill.allRules[h]||(stylefill.allRules[h]=new Object),stylefill.allRules[h][a]=i,g++}c(d)}}},type={kerningPairs:function(a){var b=function(a,d){var e;if(1===a.nodeType){if(a=a.firstChild)do e=a.nextSibling,b(a,d);while(a=e)}else 3===a.nodeType&&c(a,d)},c=function(a,b){for(var c=a.textContent,d=c.split(""),e=a.parentNode,f=b.length;f-->0;)for(var g=b[f].replace(/^([\s\n\r\t]+|\/\*.*?\*\/)+/,"").replace(/[\s\n\r\t]+$/,""),h=g.match(/^(.)(.)\s/i),i=g.match(/\s(\-*[0-9.]+[a-z]+)$/i)[1],j=d.length;j-->0;){var k=d[j],l=d[j+1],n=new RegExp("^(<span[^>]+>)*"+h[2]+"(</s*spans*>)*$","i");k==h[1]&&l&&l.match(n)&&(d[j]='<span style="letter-spacing:'+i+'">'+k+"</span>")}var o=document.createElement("div");for(o.innerHTML=d.join("");o.firstChild;)e.insertBefore(o.firstChild,a);e.removeChild(a)},d=function(){for(i in a)if(a[i]&&"none"!=a[i])for(var c=a[i],d=document.querySelectorAll(c.selector),e=d.length,f=c.value,g=f.split(",");e-->0;){var h=d[e];b(h,g)}};window.addEventListener("load",d,!1)},ragAdjust:function(a){for(i in a)for(var b=a[i],c=document.querySelectorAll(b.selector),d=c.length,e=/(\s|^|>)((aboard|about|above|across|after|against|along|amid|among|anti|around|before|behind|below|beneath|beside|besides|between|beyond|concerning|considering|despite|down|during|except|excepting|excluding|following|from|inside|into|like|minus|near|onto|opposite|outside|over|past|plus|regarding|round|save|since|than|that|this|through|toward|towards|under|underneath|unlike|until|upon|versus|with|within|without)\s)+/gi,f=/(\s|^)(([a-zA-Z-_(]{1,2}('|\u2019)*[a-zA-Z-_,;]{0,1}?\s)+)/gi,g=/([-\u2013\u2014])\s/gi,h=/(<(strong|em|b|i|a)[^>]+>)(([^\s]+\s*){2,3})?(<\/(strong|em|b|i|a)>)/gi;d-->0;){var j=c[d],k=j.innerHTML;("prepositions"==b.value||"all"==b.value)&&(k=k.replace(e,function(a,b,c){return b+c.replace(/\s/gi,"&#160;")})),("small-words"==b.value||"all"==b.value)&&(k=k.replace(f,function(a,b,c){return b+c.replace(/\s/g,"&#160;")})),("dashes"==b.value||"all"==b.value)&&(k=k.replace(g,function(a){return a.replace(/\s/g,"&#160;")})),("emphasis"==b.value||"all"==b.value)&&(k=k.replace(h,function(a,b,c,d,e,f){return b+d.replace(/\s/gi,"&#160;")+f})),j.innerHTML=k}},maxFontSize:function(a){for(i in a){var b=a[i];"none"!=b.value&&type.minMaxFontSize(b.selector)}},minFontSize:function(a){for(i in a){var b=a[i];"none"!=b.value&&type.minMaxFontSize(b.selector)}},minMaxFontSize:function(a){var b=function(){for(var b=document.querySelectorAll(a),c=b.length;c-->0;){var d=b[c],e=stylefill.allRules[a],f=e["max-font-size"],g=e["min-font-size"];d.style.fontSize="";var h=parseFloat(window.getComputedStyle(d,null).getPropertyValue("font-size"));h<=parseFloat(g)?d.style.fontSize=g:h>=parseFloat(f)&&(d.style.fontSize=f)}};a&&(b(),window.addEventListener("resize",b,!1))},widowAdjust:function(a){var b=function(a){return a.replace(/-([a-zA-Z])/g,function(a){return a.replace("-","").toUpperCase()})},c=function(a){return a.innerText||a.textContent},d=function(a,b){a.innerHTML=b},e=function(a,b){if(a.offsetHeight>type.getStyle(a,"line-height",!0)){var d=a.childNodes,e=d.length-1,h=c(a);if(h){for(e in d)d[e].innerHTML&&(d[e].style["line-height"]="1 !important");var i=a.offsetHeight;f(h,a,i,0,b)}}},f=function(a,b,c,e,g){var h=b.innerHTML;if(d(b,a.slice(0,-14)),b.offsetHeight<c)if("nonBreakingSpace"==g)d(b,h.replace(/\s([^\s]+)$/,"&#160;$1"));else{var i=g.match("padding")?1:5,j=g.match("padding")?e/100:e/1e3;g.match("Spacing")&&(i=-1*i),g.match("padding")&&(b.style.boxSizing="border-box"),b.style[g]=j+"em",d(b,h),500>e&&f(a,b,c,e+i,g)}else d(b,h)},g=function(){for(i in a){var c=a[i];if(c){var d=document.querySelectorAll(c.selector),f=d.length,g=b(c.value);switch(g){case"paddingRight":case"nonBreakingSpace":case"paddingLeft":case"wordSpacing":case"letterSpacing":case void 0:for(;f-->0;)e(d[f],g);break;default:console.log("Invalid method. Please use either padding-right, padding-left, word-spacing, or letter-spacing.")}}}};window.addEventListener("load",g,!1)},getStyle:function(a,b,c){var d;return a.currentStyle?d=a.currentStyle[b.replace(/-([A-z])/gi,function(a,b){return b.toUpperCase()})]:window.getComputedStyle&&(d=document.defaultView.getComputedStyle(a,null).getPropertyValue(b)),c?parseFloat(d):d}};stylefill.options({externalCSS:!1}),stylefill.init({"max-font-size":type.maxFontSize,"min-font-size":type.minFontSize,"kerning-pairs":type.kerningPairs,"rag-adjust":type.ragAdjust,"widow-adjust":type.widowAdjust});